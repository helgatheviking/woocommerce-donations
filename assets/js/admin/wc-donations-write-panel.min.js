/*!    */

jQuery(function(n){"use strict";var i={init:function(){n(".product_data_tabs").find(".donation_options").find("a").click()},reload:function(){t.load_variations(1)},notice_dismiss:function(){n(this).closest("div.notice").remove()},variations_loaded:function(a,o){o=o||!1;var e=n("#woocommerce-product-data");o||(n(".woocommerce_variation",e).each(function(a,o){var e=n(o),i=n(".sale_price_dates_from",e).val(),t=n(".sale_price_dates_to",e).val();""===i&&""===t||n("a.sale_schedule",e).click()}),n(".woocommerce_variations .variation-needs-update",e).removeClass("variation-needs-update"),n("button.cancel-variation-changes, button.save-variation-changes",e).attr("disabled","disabled")),n("#tiptip_holder").removeAttr("style"),n("#tiptip_arrow").removeAttr("style"),n(".woocommerce_variations .tips, .woocommerce_variations .help_tip, .woocommerce_variations .woocommerce-help-tip",e).tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),n(".sale_price_dates_fields",e).find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,onSelect:function(){var a=n(this).is(".sale_price_dates_from")?"minDate":"maxDate",o=n(this).closest(".sale_price_dates_fields").find("input"),e=n(this).datepicker("getDate");o.not(this).datepicker("option",a,e),n(this).change()}}),n(".woocommerce_variations",e).sortable({items:".woocommerce_variation",cursor:"move",axis:"y",handle:".sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,stop:function(){i.variation_row_indexes()}}),n(document.body).trigger("wc-enhanced-select-init")},variation_added:function(a,o){1===o&&i.variations_loaded(null,!0)},variation_row_indexes:function(){var a=n("#variable_product_options").find(".woocommerce_variations"),o=parseInt(a.attr("data-page"),10),e=parseInt((o-1)*woocommerce_admin_meta_boxes_variations.variations_per_page,10);n(".woocommerce_variations .woocommerce_variation").each(function(a,o){n(".variation_menu_order",o).val(parseInt(n(o).index(".woocommerce_variations .woocommerce_variation"),10)+1+e).change()})}},t={init:function(){n("li.variations_tab a").on("click",this.initial_load),n("#variable_product_options").on("click","button.save-variation-changes",this.save_variations).on("click","button.cancel-variation-changes",this.cancel_variations).on("click",".remove_variation",this.remove_variation),n(document.body).on("change","#variable_product_options .woocommerce_variations :input",this.input_changed).on("change",".variations-defaults select",this.defaults_changed),n("form#post").on("submit",this.save_on_submit),n(".wc-metaboxes-wrapper").on("click","a.do_variation_action",this.do_variation_action)},check_for_changes:function(){var a=n("#variable_product_options").find(".woocommerce_variations .variation-needs-update");if(0<a.length){if(!window.confirm(woocommerce_admin_meta_boxes_variations.i18n_edited_variations))return a.removeClass("variation-needs-update"),!1;t.save_changes()}return!0},block:function(){n("#woocommerce-product-data").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){n("#woocommerce-product-data").unblock()},initial_load:function(){0===n("#variable_product_options").find(".woocommerce_variations .woocommerce_variation").length&&wc_meta_boxes_donation_variations_pagenav.go_to_page()},load_variations:function(o,a){o=o||1,a=a||woocommerce_admin_meta_boxes_variations.variations_per_page;var e=n("#variable_product_options").find(".woocommerce_variations");t.block(),n.ajax({url:woocommerce_admin_meta_boxes_variations.ajax_url,data:{action:"woocommerce_load_variations",security:woocommerce_admin_meta_boxes_variations.load_variations_nonce,product_id:woocommerce_admin_meta_boxes_variations.post_id,attributes:e.data("attributes"),page:o,per_page:a},type:"POST",success:function(a){e.empty().append(a).attr("data-page",o),n("#woocommerce-product-data").trigger("woocommerce_variations_loaded"),t.unblock()}})},get_variations_fields:function(a){var i=n(":input",a).serializeJSON();return n(".variations-defaults select").each(function(a,o){var e=n(o);i[e.attr("name")]=e.val()}),i},save_changes:function(o){var a=n("#variable_product_options").find(".woocommerce_variations"),e=n(".variation-needs-update",a),i={};0<e.length&&(t.block(),(i=t.get_variations_fields(e)).action="woocommerce_save_variations",i.security=woocommerce_admin_meta_boxes_variations.save_variations_nonce,i.product_id=woocommerce_admin_meta_boxes_variations.post_id,i["product-type"]=n("#product-type").val(),n.ajax({url:woocommerce_admin_meta_boxes_variations.ajax_url,data:i,type:"POST",success:function(a){e.removeClass("variation-needs-update"),n("button.cancel-variation-changes, button.save-variation-changes").attr("disabled","disabled"),n("#woocommerce-product-data").trigger("woocommerce_variations_saved"),"function"==typeof o&&o(a),t.unblock()}}))},save_variations:function(){return n("#variable_product_options").trigger("woocommerce_variations_save_variations_button"),t.save_changes(function(a){var o=n("#variable_product_options").find(".woocommerce_variations");n("#variable_product_options").find("#woocommerce_errors").remove(),a&&o.before(a),n(".variations-defaults select").each(function(){n(this).attr("data-current",n(this).val())})}),!1},save_on_submit:function(a){0<n("#variable_product_options").find(".woocommerce_variations .variation-needs-update").length&&(a.preventDefault(),n("#variable_product_options").trigger("woocommerce_variations_save_variations_on_submit"),t.save_changes(t.save_on_submit_done))},save_on_submit_done:function(){n("form#post").submit()},cancel_variations:function(){parseInt(n("#variable_product_options").find(".woocommerce_variations").attr("data-page"),10);return n("#variable_product_options").find(".woocommerce_variations .variation-needs-update").removeClass("variation-needs-update"),n(".variations-defaults select").each(function(){n(this).val(n(this).attr("data-current"))}),!1},add_variation:function(){t.block();var a={action:"woocommerce_add_variation",post_id:woocommerce_admin_meta_boxes_variations.post_id,loop:n(".woocommerce_variation").length,security:woocommerce_admin_meta_boxes_variations.add_variation_nonce};return n.post(woocommerce_admin_meta_boxes_variations.ajax_url,a,function(a){var o=n(a);o.addClass("variation-needs-update"),n("#variable_product_options").find(".woocommerce_variations").prepend(o),n("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled"),n("#variable_product_options").trigger("woocommerce_variations_added",1),t.unblock()}),!1},remove_variation:function(){if(t.check_for_changes(),window.confirm(woocommerce_admin_meta_boxes_variations.i18n_remove_variation)){var a=n(this).attr("rel"),o=[],e={action:"woocommerce_remove_variations"};t.block(),0<a?(o.push(a),e.variation_ids=o,e.security=woocommerce_admin_meta_boxes_variations.delete_variations_nonce,n.post(woocommerce_admin_meta_boxes_variations.ajax_url,e,function(){var a=n("#variable_product_options").find(".woocommerce_variations"),o=parseInt(a.attr("data-page"),10),e=Math.ceil((parseInt(a.attr("data-total"),10)-1)/woocommerce_admin_meta_boxes_variations.variations_per_page);n("#woocommerce-product-data").trigger("woocommerce_variations_removed")})):t.unblock()}return!1},input_changed:function(){n(this).closest(".woocommerce_variation").addClass("variation-needs-update"),n("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled"),n("#variable_product_options").trigger("woocommerce_variations_input_changed")},defaults_changed:function(){n(this).closest("#variable_product_options").find(".woocommerce_variation:first").addClass("variation-needs-update"),n("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled"),n("#variable_product_options").trigger("woocommerce_variations_defaults_changed")}};i.init()});